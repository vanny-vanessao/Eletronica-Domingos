<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novo Registro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/estilos/nr.css">
</head>
<body>
    <div class="principal">
        <div class="cabecalho">
            <h1 class="logo">Novo Registro</h1>
            <a href="/novo-aparelho" class="btn-voltar">
                <i class="fas fa-arrow-left"></i> Voltar
            </a>
        </div>

        <div class="container-fluid">
            <form class="w-100" action="/pendentes/novo-registro" method="POST">
                <h4>Informações do Registro</h4>

                <p>Data Estimada</p>
                <input type="date" class="form-control" name="data_estimada">

                <p>Orçamento</p>
                <input type="number" step="0.01" class="form-control" name="orcamento" placeholder="Valor do orçamento">

                <p>Observações</p>
                <textarea class="form-control" name="obs" rows="4" placeholder="Observações adicionais..."></textarea>
                <input type="hidden" name="id_cliente" value="<%= id_cliente %>">
                <input type="hidden" name="id_aparelho" value="<%= id_aparelho %>">

                <div class="btn-container">
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    <style>
      .input-with-currency{position:relative;}
      .input-with-currency .currency-prefix{position:absolute; left:12px; top:50%; transform:translateY(-50%); color:#444; font-weight:600; pointer-events:none;}
      .input-with-currency input{padding-left:48px;}
    </style>
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        const selectors = [
          'input[name*="orc" i]',
          'input[name*="valor" i]',
          'input[placeholder*="orc" i]',
          'input[placeholder*="valor" i]',
          'input[type="number"]'
        ];

        const candidates = new Set();
        selectors.forEach(sel => {
          document.querySelectorAll(sel).forEach(el => candidates.add(el));
        });

        document.querySelectorAll('label').forEach(label => {
          const txt = label.textContent.trim().toLowerCase();
          if (txt.includes('orcamento') || txt.includes('valor')) {
            const forId = label.getAttribute('for');
            if (forId) {
              const el = document.getElementById(forId);
              if (el) candidates.add(el);
            } else {
              const input = label.closest('.form-group')?.querySelector('input,textarea,select');
              if (input) candidates.add(input);
            }
          }
        });

        Array.from(candidates).forEach(function(inp){
          if (!inp) return;
          if (!(inp instanceof HTMLInputElement)) return;
          const style = window.getComputedStyle(inp);
          if (style.display === 'none' || style.visibility === 'hidden') return;
          if (inp.closest('.input-with-currency')) return;

          const t = inp.getAttribute('type') || 'text';
          const name = (inp.getAttribute('name') || '').toLowerCase();
          const placeholder = (inp.getAttribute('placeholder') || '').toLowerCase();

          const looksLikeCurrency = t === 'number' || name.includes('orc') || name.includes('valor') || placeholder.includes('orc') || placeholder.includes('valor');

          if (!looksLikeCurrency) return;

          const wrapper = document.createElement('div');
          wrapper.className = 'input-with-currency';
          const span = document.createElement('span');
          span.className = 'currency-prefix';
          span.setAttribute('aria-hidden','true');
          span.textContent = 'R$';
          inp.parentNode.insertBefore(wrapper, inp);
          wrapper.appendChild(span);
          wrapper.appendChild(inp);
          if (!inp.style.paddingLeft) inp.style.paddingLeft = '48px';
        });
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
